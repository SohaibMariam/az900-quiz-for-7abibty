<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>AZ-900 Exam Simulator</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <style>
    /* --- (All your existing CSS remains unchanged) --- */
    :root {
      --primary: #2563eb;
      --azure: #0078d4;
      --bg-light: #f4f6fa;
      --bg-dark: #181a20;
      --text-light: #222;
      --text-dark: #fafafa;
      --card-light: #fff;
      --card-dark: #23272f;
      --accent: #3b82f6;
      --transition: 0.2s;
      --radius: 1rem;
      --font-main: 'Inter', 'Roboto', Arial, sans-serif;
    }
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      font-family: var(--font-main);
      background: var(--bg-light);
      color: var(--text-light);
      min-height: 100vh;
      transition: background var(--transition), color var(--transition);
    }
    body.dark {
      background: var(--bg-dark);
      color: var(--text-dark);
    }
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1.2rem 1rem 1rem 1rem;
      background: var(--card-light);
      border-bottom: 1px solid #e3e5ea;
      transition: background var(--transition);
    }
    body.dark header {
      background: var(--card-dark);
      border-bottom: 1px solid #2d313a;
    }
    .logo-azure {
      display: flex;
      align-items: center;
      gap: 0.7rem;
    }
    .azure-svg {
      width: 82px;
      height: 54px;
      display: block;
      margin-right: 0.5rem;
      background: transparent;
      max-width: 100px;
      height: auto;
    }
    .app-title {
      font-size: 1.3rem;
      font-weight: 700;
      letter-spacing: -1px;
      color: var(--azure);
      white-space: nowrap;
      margin-left: 0.7rem;
    }
    .header-actions {
      display: flex;
      align-items: center;
      gap: 1rem;
    }
    .toggle-btn, .lang-btn {
      background: none;
      border: none;
      font-size: 1.2rem;
      cursor: pointer;
      padding: 0.5rem 0.7rem;
      border-radius: 0.5rem;
      transition: background 0.18s;
      color: inherit;
    }
    .toggle-btn:focus, .lang-btn:focus {
      outline: 2px solid var(--accent);
    }
    .toggle-btn:hover, .lang-btn:hover {
      background: #e3e9f6;
    }
    body.dark .toggle-btn:hover, body.dark .lang-btn:hover {
      background: #23272f;
    }
    main {
      min-height: 90vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding: 2rem 0.75rem;
    }
    .card {
      background: var(--card-light);
      border-radius: var(--radius);
      box-shadow: 0 4px 24px 0 rgba(30,41,59,0.06), 0 1.5px 3px 0 rgba(30,41,59,0.04);
      padding: 2.1rem 1.1rem 1.7rem 1.1rem;
      max-width: 480px;
      width: 100%;
      margin: 0 auto;
      transition: background var(--transition), color var(--transition);
      box-sizing: border-box;
    }
    body.dark .card {
      background: var(--card-dark);
      color: var(--text-dark);
      box-shadow: 0 4px 24px 0 rgba(0,0,0,0.16), 0 1.5px 3px 0 rgba(0,0,0,0.10);
    }
    .landing-header {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1.4rem;
      margin-bottom: 2rem;
    }
    .sm-logo-img {
      display: block;
      width: 200px;
      height: 200px;
      max-width: 41vw;
      max-height: 41vw;
      margin: 0 auto 0.5rem auto;
      object-fit: contain;
      border-radius: 50%;
      background: #fff;
      border: 1px solid #e5e7eb;
      box-shadow: 0 2px 8px 0 #0001;
    }
    .welcome {
      font-size: 1.1rem;
      font-weight: 600;
      text-align: center;
      color: var(--primary);
      word-break: break-word;
    }
    .select-section {
      margin: 2rem 0 1rem 0;
      display: flex;
      flex-direction: column;
      gap: 1.2rem;
    }
    .select-row {
      display: flex;
      align-items: center;
      gap: 1.1rem;
      font-size: 1rem;
      justify-content: space-between;
      flex-wrap: wrap;
    }
    .select-row label {
      font-weight: 500;
      min-width: 120px;
    }
    select {
      font-size: 1.08rem;
      padding: 0.43em 0.95em;
      border-radius: 0.5em;
      border: 1px solid #d7d8db;
      background: var(--bg-light);
      color: var(--text-light);
      transition: background var(--transition), color var(--transition);
      width: 110px;
    }
    body.dark select {
      background: var(--bg-dark);
      color: var(--text-dark);
      border: 1px solid #353b47;
    }
    .exam-time {
      font-size: 1.08rem;
      color: var(--azure);
      font-weight: 500;
      margin-left: 0.32em;
    }
    .start-btn {
      padding: 0.82em 2.1em;
      font-size: 1.13rem;
      border: none;
      border-radius: 0.55em;
      background: var(--azure);
      color: #fff;
      font-weight: 700;
      cursor: pointer;
      letter-spacing: 0.02em;
      margin-top: 1.6rem;
      transition: background var(--transition), color var(--transition), box-shadow var(--transition);
      box-shadow: 0 2px 10px 0 #0078d43a;
    }
    .start-btn:hover, .next-btn:hover, .submit-btn:hover {
      background: var(--accent);
      color: #fff;
    }
    .exam-section {
      display: flex;
      flex-direction: column;
      gap: 2.1rem;
      align-items: stretch;
    }
    .question-no {
      font-size: 1rem;
      color: var(--accent);
      margin-bottom: 0.5rem;
      font-weight: 600;
    }
    .question-text {
      font-size: 1.05rem;
      font-weight: 500;
      margin-bottom: 1.4rem;
      word-break: break-word;
    }
    .options-list {
      display: flex;
      flex-direction: column;
      gap: 1.1rem;
    }
    .option-label {
      font-size: 1.03rem;
      padding: 0.65em 0.7em;
      border-radius: 0.55em;
      border: 1.5px solid #dbeafe;
      background: #f3f7fd;
      cursor: pointer;
      transition: background var(--transition), color var(--transition), border var(--transition);
      display: flex;
      align-items: center;
      gap: 0.7em;
      user-select: none;
      line-height: 1.2;
    }
    .option-input:checked + .option-label {
      background: var(--accent);
      color: #fff;
      border: 1.5px solid var(--accent);
    }
    .option-input {
      margin-right: 0.75em;
      accent-color: var(--azure);
    }
    body.dark .option-label {
      background: #22242a;
      border: 1.5px solid #353b47;
      color: var(--text-dark);
    }
    body.dark .option-input:checked + .option-label {
      background: var(--accent);
      color: #fff;
      border: 1.5px solid var(--accent);
    }
    .next-btn, .submit-btn {
      margin-top: 1.6rem;
      padding: 0.82em 2.1em;
      font-size: 1.13rem;
      border: none;
      border-radius: 0.55em;
      background: var(--primary);
      color: #fff;
      font-weight: 700;
      cursor: pointer;
      letter-spacing: 0.02em;
      transition: background var(--transition), color var(--transition), box-shadow var(--transition);
      box-shadow: 0 2px 10px 0 #2563eb2a;
      align-self: flex-end;
    }
    .submit-btn {
      background: var(--azure);
      box-shadow: 0 2px 10px 0 #0078d43a;
    }
    .timer {
      font-size: 1.05rem;
      color: #eab308;
      font-weight: 600;
      margin-bottom: -1.2rem;
      margin-top: 0.9rem;
      text-align: right;
    }
    .explanation-block {
      margin-top: 1.7em;
      padding: 1.1em 1em;
      background: #e0f2fe;
      border-radius: 0.7em;
      color: #0a4369;
      box-shadow: 0 0.5px 2px #0078d42e;
      font-size: 1.05rem;
      border-left: 5px solid var(--azure);
      animation: fadein 0.3s;
    }
    .explanation-block.correct {
      border-left: 5px solid #22c55e;
      background: #d1fae5;
      color: #166534;
    }
    .explanation-block.incorrect {
      border-left: 5px solid #ef4444;
      background: #fee2e2;
      color: #991b1b;
    }
    @keyframes fadein {
      from {opacity: 0;}
      to {opacity: 1;}
    }
    .results-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2.2rem;
      text-align: center;
    }
    .score {
      font-size: 2.1rem;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 0.3em;
    }
    .time-taken {
      font-size: 1.13rem;
      color: var(--accent);
      font-weight: 500;
      margin-bottom: 1.2em;
    }
    .love-message {
      font-size: 1.25rem;
      color: #ea3a5a;
      font-weight: 700;
      margin-top: 1.5em;
      margin-bottom: 0.5em;
      letter-spacing: 0.01em;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5em;
    }
    .love-answer-message {
      font-size: 1.1rem;
      color: #e11d48;
      font-weight: 500;
      margin-top: 0.5em;
      margin-bottom: 0.5em;
      letter-spacing: 0.01em;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5em;
    }
    .restart-btn {
      margin-top: 2em;
      padding: 0.75em 2.2em;
      font-size: 1.04rem;
      font-weight: 700;
      border: none;
      border-radius: 0.6em;
      background: var(--accent);
      color: #fff;
      cursor: pointer;
      transition: background var(--transition), color var(--transition);
      box-shadow: 0 2px 10px 0 #3b82f62a;
    }
    .restart-btn:hover {
      background: var(--azure);
    }
    .lang-pills {
      display: flex;
      gap: 0.28em;
    }
    .lang-btn {
      font-size: 1.03rem;
      padding: 0.38em 0.95em;
      border: none;
      background: transparent;
      font-weight: 600;
      color: #6366f1;
      border-radius: 0.5em;
      margin: 0 1px;
      transition: background var(--transition), color var(--transition);
    }
    .lang-btn.active {
      background: var(--accent);
      color: #fff;
    }
    .lang-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
    footer {
      width: 100%;
      text-align: center;
      margin-top: 3em;
      padding: 1em 0 1.2em 0;
      background: none;
    }
    .contact-footer small {
      color: #888;
      font-size: 0.96em;
    }
    .contact-footer a {
      color: #2563eb;
      text-decoration: underline dotted;
    }
    body.dark .contact-footer small {
      color: #b8b8b8;
    }
    body.dark .contact-footer a {
      color: #3b82f6;
    }
    @media (max-width: 600px) {
      body, html {
        font-size: 15px;
        min-width: 0;
      }
      header {
        flex-direction: column;
        gap: 0.7rem;
        align-items: flex-start;
        padding: 1rem 0.4rem 0.7rem 0.4rem;
      }
      .app-title {
        font-size: 1.05rem;
      }
      .azure-svg {
        width: 52px;
        height: 32px;
        min-width: 40px;
        margin-right: 0.2rem;
      }
      .sm-logo-img {
        width: 75px;
        height: 75px;
        max-width: 32vw;
        max-height: 32vw;
      }
      .card {
        padding: 1.1rem 0.3rem 1rem 0.3rem;
        max-width: 99vw;
        width: 100%;
        font-size: 1rem;
      }
      .landing-header {
        gap: 0.7rem;
        margin-bottom: 1.1rem;
      }
      .welcome {
        font-size: 1.01rem;
      }
      .select-section {
        margin: 1.1rem 0 0.5rem 0;
        gap: 0.7rem;
      }
      .select-row label {
        min-width: unset;
        font-size: 0.95em;
      }
      .start-btn, .next-btn, .submit-btn, .restart-btn {
        font-size: 1rem;
        padding: 0.7em 1.1em;
      }
      .question-no {
        font-size: 0.93rem;
      }
      .question-text {
        font-size: 0.97rem;
      }
      .option-label {
        font-size: 0.98rem;
        padding: 0.6em 0.6em;
      }
      .results-section, .exam-section {
        padding: 0;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="logo-azure">
      <!-- Azure SVG logo (header, unchanged) -->
      <svg class="azure-svg" viewBox="0 0 546 351" xmlns="http://www.w3.org/2000/svg" aria-label="Microsoft Azure Logo">
        <path d="M131.1,38.7c47.1-43.9,116.4-53.1,174.6-25.1c25,12.2,46.6,31.8,60.9,56.3c12.9-5.1,26.9-7.9,41.5-7.9
          c58.6,0,106.2,47.5,106.2,106.1c0,1-0.1,2-0.1,2.9c19.2,13.2,31.8,35,31.8,59.7c0,39.7-32.2,71.9-71.9,71.9H83.6
          c-46.1,0-83.6-37.6-83.6-83.6c0-37.9,25.6-69.7,60.5-80.5C39.8,113.3,47.1,70.7,78.1,46.6C93.6,34.5,112.1,31.7,131.1,38.7z"
          fill="#2d76bb"/>
        <g>
          <rect x="125" y="110" width="54" height="54" fill="#fff"/>
          <rect x="125" y="166" width="54" height="54" fill="#fff"/>
          <rect x="182" y="110" width="54" height="54" fill="#fff"/>
          <rect x="182" y="166" width="54" height="54" fill="#fff"/>
        </g>
        <text x="250" y="160" font-family="'Segoe UI', 'Arial', sans-serif" font-size="48" fill="#fff">Microsoft</text>
        <text x="250" y="210" font-family="'Segoe UI', 'Arial', sans-serif" font-size="60" font-weight="bold" fill="#fff">Azure</text>
      </svg>
      <span class="app-title" id="app-title">AZ-900 Simulator</span>
    </div>
    <div class="header-actions">
      <button class="toggle-btn" id="theme-toggle" title="Toggle theme" aria-label="Toggle theme">🌙</button>
      <div class="lang-pills" id="lang-pills">
        <button class="lang-btn active" data-lang="en" id="lang-en" aria-label="English">EN</button>
        <button class="lang-btn" data-lang="fr" id="lang-fr" aria-label="French">FR</button>
        <button class="lang-btn" data-lang="ar" id="lang-ar" aria-label="Arabic">AR</button>
      </div>
    </div>
  </header>
  <main>
    <div class="card" id="landing-screen">
      <div class="landing-header">
        <!-- Use your JPG logo for landing -->
        <img class="sm-logo-img" src="logo-sm.jpg" alt="S M Sohaib & Maryem Logo" />
        <div class="welcome" id="welcome-msg">
          Welcome to the AZ-900 Exam Simulator!
        </div>
      </div>
      <form id="start-form" autocomplete="off">
        <div class="select-section">
          <div class="select-row">
            <label for="exam-lang" id="exam-lang-label">Exam language</label>
            <select id="exam-lang" required>
              <option value="en" selected>English</option>
              <option value="fr">Français</option>
              <option value="ar">العربية</option>
            </select>
          </div>
          <div class="select-row">
            <label for="num-questions" id="num-questions-label">Number of questions</label>
            <select id="num-questions" required>
              <option value="5" selected>5</option>
              <option value="10">10</option>
              <option value="15">15</option>
              <option value="20">20</option>
              <option value="25">25</option>
              <option value="30">30</option>
              <option value="40">40</option>
              <option value="50">50</option>
            </select>
          </div>
          <div class="select-row">
            <label id="total-time-label">Total exam time</label>
            <span class="exam-time" id="exam-time">25 min</span>
          </div>
        </div>
        <button type="submit" class="start-btn" id="start-btn">Start Exam</button>
      </form>
    </div>
    <div class="card" id="exam-screen" style="display:none;">
      <div class="timer" id="exam-timer"></div>
      <form id="question-form" class="exam-section">
        <div>
          <div class="question-no" id="question-no"></div>
          <div class="question-text" id="question-text"></div>
        </div>
        <div class="options-list" id="options-list"></div>
        <button type="submit" class="next-btn" id="next-btn">Next</button>
        <div id="explanation-block"></div>
      </form>
      <form id="love-form" style="display:none;">
        <div class="question-no" id="love-question-no"></div>
        <div class="question-text" id="love-question-text"></div>
        <div class="options-list" id="love-options-list"></div>
        <button type="submit" class="submit-btn" id="love-submit-btn">Submit</button>
      </form>
    </div>
    <div class="card" id="results-screen" style="display:none;">
      <div class="results-section">
        <!-- Use your JPG logo for results -->
        <img class="sm-logo-img" src="logo-sm.jpg" alt="S M Sohaib & Maryem Logo" />
        <div class="score" id="score"></div>
        <div class="time-taken" id="time-taken"></div>
        <div class="love-answer-message" id="love-answer-message" style="display:none;"></div>
        <div class="love-message" id="love-message">❤️ بحبك كثير ياروحي ❤️</div>
        <button class="restart-btn" id="restart-btn"></button>
      </div>
    </div>
  </main>
  <footer>
    <div class="contact-footer">
      <small>
        For further information, contact:
        <a href="mailto:goosebumpsq@proton.me">goosebumpsq@proton.me</a>
      </small>
    </div>
  </footer>
  <script>
    // --- (Translations and questions as in previous version, omitted for brevity. Use the same as last version above.) ---
    // (PASTED FROM PREVIOUS CODE: translations, examQuestions, and all setup variables...)

    // Translation JSON for website UI
    const translations = {
      en: {
        appTitle: "AZ-900 Simulator",
        welcome: "Welcome to the AZ-900 Exam Simulator!",
        examLang: "Exam language",
        numQuestions: "Number of questions",
        totalTime: "Total exam time",
        min: "min",
        start: "Start Exam",
        next: "Next",
        submit: "Submit",
        question: "Question",
        of: "of",
        selectOption: "Select an option",
        score: "Your Score:",
        timeTaken: "Time taken:",
        restart: "Restart",
        love: "❤️ بحبك كثير ياروحي ❤️",
        explanation: "Explanation:",
        correct: "Correct!",
        incorrect: "Incorrect!",
        loveQ: "Do you love me?",
        loveOpts: ["Yes", "No", "Not sure"],
        loveLabel: "Your answer to 'Do you love me?' was: "
      },
      fr: {
        appTitle: "Simulateur AZ-900",
        welcome: "Bienvenue sur le simulateur d'examen AZ-900 !",
        examLang: "Langue de l'examen",
        numQuestions: "Nombre de questions",
        totalTime: "Temps total",
        min: "min",
        start: "Commencer l'examen",
        next: "Suivant",
        submit: "Soumettre",
        question: "Question",
        of: "sur",
        selectOption: "Sélectionnez une option",
        score: "Votre score :",
        timeTaken: "Temps écoulé :",
        restart: "Recommencer",
        love: "❤️ بحبك كثير ياروhi ❤️",
        explanation: "Explication :",
        correct: "Correct !",
        incorrect: "Incorrect !",
        loveQ: "Est-ce que tu m'aimes ?",
        loveOpts: ["Oui", "Non", "Je ne sais pas"],
        loveLabel: "Votre réponse à « Est-ce que tu m'aimes ? » était : "
      },
      ar: {
        appTitle: "محاكاة اختبار AZ-900",
        welcome: "مرحبًا بك في محاكي اختبار AZ-900!",
        examLang: "لغة الاختبار",
        numQuestions: "عدد الأسئلة",
        totalTime: "الوقت الكلي",
        min: "دقيقة",
        start: "ابدأ الاختبار",
        next: "التالي",
        submit: "إرسال",
        question: "سؤال",
        of: "من",
        selectOption: "اختر إجابة",
        score: "نتيجتك:",
        timeTaken: "الوقت المستغرق:",
        restart: "إعادة المحاولة",
        love: "❤️ بحبك كثير ياروحي ❤️",
        explanation: "التفسير:",
        correct: "إجابة صحيحة!",
        incorrect: "إجابة خاطئة!",
        loveQ: "هل تحبني؟",
        loveOpts: ["نعم", "لا", "لست متأكدًا"],
        loveLabel: "إجابتك عن « هل تحبني؟ » كانت: "
      }
    };
    let currentLang = 'fr'; // Website UI language
    let currentExamLang = 'en'; // Exam question language

    // --- AZ-900 unique questions (add more to reach 50 per language as needed; for brevity here, 5 per language) ---
    const examQuestions = {
      en: [
        // ... (Use same sample questions as previously provided)
        {
          q: "Which Azure service is primarily used for hosting virtual machines?",
          opts: [
            "Azure Virtual Machines",
            "Azure Blob Storage",
            "Azure SQL Database",
            "Azure Logic Apps"
          ],
          answer: 0,
          reason: "Azure Virtual Machines is the core service for running Windows and Linux virtual machines in the cloud."
        },
        {
          q: "What is the main benefit of cloud computing?",
          opts: [
            "Local hardware ownership",
            "Scalability on demand",
            "Manual backups",
            "Fixed pricing"
          ],
          answer: 1,
          reason: "Cloud computing provides scalability, allowing you to increase or decrease resources as needed."
        },
        {
          q: "Which Azure service provides a managed relational database?",
          opts: [
            "Azure Cosmos DB",
            "Azure SQL Database",
            "Azure Virtual Network",
            "Azure Functions"
          ],
          answer: 1,
          reason: "Azure SQL Database is a fully managed relational database service."
        },
        {
          q: "Which option allows you to deploy and manage resources via code?",
          opts: [
            "Azure Portal",
            "Azure CLI",
            "Azure Resource Manager Templates",
            "Azure Billing"
          ],
          answer: 2,
          reason: "Azure Resource Manager Templates allow you to define and deploy infrastructure as code."
        },
        {
          q: "What is Azure Active Directory mainly used for?",
          opts: [
            "Data storage",
            "Identity and access management",
            "Virtual machine hosting",
            "Backup services"
          ],
          answer: 1,
          reason: "Azure AD is used for identity and access management in the cloud."
        }
      ],
      fr: [
        {
          q: "Laquelle des affirmations suivantes est une caractéristique du cloud public ?",
          opts: [
            "Vous possédez le matériel",
            "Vous êtes responsable de la gestion du centre de données",
            "Les ressources sont détenues et exploitées par un fournisseur de cloud tiers",
            "Il est uniquement accessible depuis votre réseau local"
          ],
          answer: 2,
          reason: "Dans un modèle de cloud public, les ressources sont gérées par un fournisseur comme Microsoft Azure. L'utilisateur y accède via Internet."
        },
        {
          q: "Lequel modèle de service cloud vous offre le plus haut niveau de contrôle sur l'infrastructure sous-jacente ?",
          opts: [
            "SaaS",
            "PaaS",
            "IaaS",
            "Sans serveur (Serverless)"
          ],
          answer: 2,
          reason: "Avec IaaS, vous gérez les machines virtuelles, le stockage et le réseau. Microsoft gère le matériel physique et la virtualisation."
        },
        {
          q: "Lequel est le but des régions Azure ?",
          opts: [
            "Regrouper les abonnements",
            "Définir les niveaux de tarification",
            "Fournir des emplacements géographiques pour les ressources",
            "Organiser les groupes de gestion"
          ],
          answer: 2,
          reason: "Les régions Azure sont des zones géographiques contenant des centres de données pour placer les ressources selon les besoins."
        },
        {
          q: "Lequel outil permet d’estimer le coût d’une solution sur Azure ?",
          opts: [
            "Azure Portal",
            "Azure Monitor",
            "Calculateur de prix Azure",
            "Azure Cost Management"
          ],
          answer: 2,
          reason: "Le Calculateur de prix Azure est un outil gratuit pour estimer les coûts avant le déploiement de ressources."
        },
        {
          q: "Lequel service Azure est utilisé pour gérer les identités des utilisateurs et les accès ?",
          opts: [
            "Azure Firewall",
            "Azure Active Directory (Azure AD)",
            "Azure DevOps",
            "Azure Key Vault"
          ],
          answer: 1,
          reason: "Azure AD permet de gérer les utilisateurs, groupes et autorisations dans le cloud Microsoft."
        }
      ],
      ar: [
        {
          q: "أي من خدمات Azure تُستخدم أساسًا لاستضافة الأجهزة الافتراضية؟",
          opts: [
            "Azure Virtual Machines",
            "Azure Blob Storage",
            "Azure SQL Database",
            "Azure Logic Apps"
          ],
          answer: 0,
          reason: "خدمة Azure Virtual Machines هي الخدمة الأساسية لتشغيل الأجهزة الافتراضية بنظامي Windows وLinux على السحابة."
        },
        {
          q: "ما هي الفائدة الرئيسية للحوسبة السحابية؟",
          opts: [
            "امتلاك الأجهزة محليًا",
            "قابلية التوسع عند الطلب",
            "النسخ الاحتياطي اليدوي",
            "تسعير ثابت"
          ],
          answer: 1,
          reason: "توفر الحوسبة السحابية قابلية التوسع، مما يسمح لك بزيادة أو تقليل الموارد حسب الحاجة."
        },
        {
          q: "أي خدمة Azure توفر قاعدة بيانات علائقية مُدارة؟",
          opts: [
            "Azure Cosmos DB",
            "Azure SQL Database",
            "Azure Virtual Network",
            "Azure Functions"
          ],
          answer: 1,
          reason: "Azure SQL Database هي خدمة قاعدة بيانات علائقية مُدارة بالكامل."
        },
        {
          q: "أي خيار يسمح لك بنشر وإدارة الموارد عبر الشيفرة البرمجية؟",
          opts: [
            "Azure Portal",
            "Azure CLI",
            "Azure Resource Manager Templates",
            "Azure Billing"
          ],
          answer: 2,
          reason: "تتيح لك قوالب Azure Resource Manager تعريف ونشر البنية التحتية كرمز."
        },
        {
          q: "ما هو الاستخدام الرئيسي لـ Azure Active Directory؟",
          opts: [
            "تخزين البيانات",
            "إدارة الهوية والوصول",
            "استضافة الأجهزة الافتراضية",
            "خدمات النسخ الاحتياطي"
          ],
          answer: 1,
          reason: "Azure AD تُستخدم لإدارة الهوية والوصول في السحابة."
        }
      ]
    };

    // -- DOM Elements --
    const landingScreen = document.getElementById('landing-screen');
    const examScreen = document.getElementById('exam-screen');
    const resultsScreen = document.getElementById('results-screen');
    const numQuestionsSelect = document.getElementById('num-questions');
    const examTimeSpan = document.getElementById('exam-time');
    const startForm = document.getElementById('start-form');
    const questionNoDiv = document.getElementById('question-no');
    const questionTextDiv = document.getElementById('question-text');
    const optionsListDiv = document.getElementById('options-list');
    const nextBtn = document.getElementById('next-btn');
    const questionForm = document.getElementById('question-form');
    const loveForm = document.getElementById('love-form');
    const loveQuestionNoDiv = document.getElementById('love-question-no');
    const loveQuestionTextDiv = document.getElementById('love-question-text');
    const loveOptionsListDiv = document.getElementById('love-options-list');
    const loveSubmitBtn = document.getElementById('love-submit-btn');
    const examTimerDiv = document.getElementById('exam-timer');
    const scoreDiv = document.getElementById('score');
    const timeTakenDiv = document.getElementById('time-taken');
    const loveMsgDiv = document.getElementById('love-message');
    const loveAnswerMsgDiv = document.getElementById('love-answer-message');
    const restartBtn = document.getElementById('restart-btn');
    const appTitle = document.getElementById('app-title');
    const welcomeMsg = document.getElementById('welcome-msg');
    const numQuestionsLabel = document.getElementById('num-questions-label');
    const totalTimeLabel = document.getElementById('total-time-label');
    const langPills = document.getElementById('lang-pills');
    const explanationDiv = document.getElementById('explanation-block');
    const examLangSelect = document.getElementById('exam-lang');
    const examLangLabel = document.getElementById('exam-lang-label');
    let questions = [];
    let numQuestions = 5;
    let currentQ = 0;
    let answers = [];
    let loveAnswer = null;
    let startTime = null;
    let timerInterval = null;
    let showFeedback = false;

    // Theme switching
    const themeBtn = document.getElementById('theme-toggle');
    function setTheme(dark) {
      document.body.classList.toggle('dark', dark);
      themeBtn.textContent = dark ? '☀️' : '🌙';
      localStorage.setItem('az900-theme', dark ? 'dark' : 'light');
    }
    setTheme(localStorage.getItem('az900-theme') === 'dark' ||
      (localStorage.getItem('az900-theme') === null && window.matchMedia('(prefers-color-scheme: dark)').matches));
    themeBtn.addEventListener('click', () => {
      setTheme(!document.body.classList.contains('dark'));
    });

    // Website language switch
    function setLang(lang) {
      if (!translations[lang]) lang = 'en';
      currentLang = lang;
      appTitle.textContent = translations[lang].appTitle;
      welcomeMsg.textContent = translations[lang].welcome;
      numQuestionsLabel.textContent = translations[lang].numQuestions;
      totalTimeLabel.textContent = translations[lang].totalTime;
      examLangLabel.textContent = translations[lang].examLang;
      startForm.querySelector('.start-btn').textContent = translations[lang].start;
      nextBtn.textContent = translations[lang].next;
      restartBtn.textContent = translations[lang].restart;
      loveMsgDiv.textContent = translations[lang].love;
      document.documentElement.dir = (lang === 'ar') ? 'rtl' : 'ltr';
      for (const btn of langPills.children) {
        btn.classList.toggle('active', btn.dataset.lang === lang);
      }
      updateExamTime();
      if (examScreen.style.display !== 'none') renderQuestion();
      if (resultsScreen.style.display !== 'none') renderResults();
    }
    for (const btn of langPills.children) {
      btn.addEventListener('click', () => setLang(btn.dataset.lang));
    }
    setLang('fr');

    // Exam language selection (dropdown)
    examLangSelect.addEventListener('change', updateNumQuestionOptions);

    function updateNumQuestionOptions() {
      const lang = examLangSelect.value;
      const maxQ = Math.max(5, Math.min(50, examQuestions[lang]?.length || 0));
      for (let i = 0; i < numQuestionsSelect.options.length; ++i) {
        const opt = numQuestionsSelect.options[i];
        if (parseInt(opt.value, 10) <= maxQ) {
          opt.disabled = false;
        } else {
          opt.disabled = true;
        }
      }
      if (parseInt(numQuestionsSelect.value, 10) > maxQ) {
        numQuestionsSelect.value = maxQ.toString();
      }
      updateExamTime();
    }
    numQuestionsSelect.addEventListener('change', updateExamTime);

    function updateExamTime() {
      const n = parseInt(numQuestionsSelect.value, 10);
      examTimeSpan.textContent = `${n * 5} ${translations[currentLang].min}`;
    }

    function getQuestionSet() {
      return examQuestions[examLangSelect.value] || [];
    }

    function pickNUniqueRandom(arr, n) {
      if (n > arr.length) n = arr.length;
      const copy = arr.slice();
      for (let i = copy.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [copy[i], copy[j]] = [copy[j], copy[i]];
      }
      return copy.slice(0, n);
    }

    // ----- Exam flow -----
    startForm.addEventListener('submit', (e) => {
      e.preventDefault();
      numQuestions = parseInt(numQuestionsSelect.value, 10);
      currentExamLang = examLangSelect.value;
      const pool = getQuestionSet();
      questions = pickNUniqueRandom(pool, numQuestions);
      answers = Array(questions.length).fill(null);
      loveAnswer = null;
      currentQ = 0;
      showFeedback = false;
      landingScreen.style.display = 'none';
      resultsScreen.style.display = 'none';
      examScreen.style.display = '';
      questionForm.style.display = '';
      loveForm.style.display = 'none';
      startTime = Date.now();
      updateTimer();
      timerInterval = setInterval(updateTimer, 1000);
      renderQuestion();
    });

    function renderQuestion() {
      const t = translations[currentLang];
      const examT = translations[currentExamLang] || t;
      if (currentQ < questions.length) {
        questionNoDiv.textContent = `${examT.question} ${currentQ+1} ${examT.of} ${questions.length}`;
        questionTextDiv.textContent = questions[currentQ].q;
        optionsListDiv.innerHTML = '';
        explanationDiv.innerHTML = '';
        let disabled = showFeedback;
        questions[currentQ].opts.forEach((opt, idx) => {
          const id = `qopt_${currentQ}_${idx}`;
          const optDiv = document.createElement('div');
          optDiv.style.display = 'flex';
          optDiv.style.alignItems = 'center';
          const input = document.createElement('input');
          input.type = 'radio';
          input.id = id;
          input.name = 'option';
          input.value = idx;
          input.className = 'option-input';
          input.required = true;
          input.disabled = disabled;
          if (answers[currentQ] === idx) input.checked = true;
          const label = document.createElement('label');
          label.htmlFor = id;
          label.className = 'option-label';
          label.textContent = opt;
          if (showFeedback) {
            if (idx === questions[currentQ].answer) {
              label.style.borderColor = "#22c55e";
              label.style.boxShadow = "0 0 0 2px rgba(34,197,94,0.18)";
            }
            if (answers[currentQ] === idx && answers[currentQ] !== questions[currentQ].answer) {
              label.style.borderColor = "#ef4444";
              label.style.boxShadow = "0 0 0 2px rgba(239,68,68,0.13)";
            }
          }
          optDiv.appendChild(input);
          optDiv.appendChild(label);
          optionsListDiv.appendChild(optDiv);
        });
        if (!showFeedback) {
          nextBtn.textContent = (currentQ === questions.length - 1) ? examT.next : examT.next;
          nextBtn.className = (currentQ === questions.length - 1) ? 'next-btn' : 'next-btn';
          nextBtn.disabled = false;
        } else {
          nextBtn.textContent = (currentQ === questions.length - 1) ? examT.next : examT.next;
          nextBtn.className = (currentQ === questions.length - 1) ? 'next-btn' : 'next-btn';
          nextBtn.disabled = false;
        }
        if (showFeedback) {
          let isCorrect = (answers[currentQ] === questions[currentQ].answer);
          let block = document.createElement('div');
          block.className = 'explanation-block ' + (isCorrect ? 'correct' : 'incorrect');
          block.innerHTML = `<strong>${isCorrect ? examT.correct : examT.incorrect}</strong><br>
            <b>${examT.explanation}</b> ${questions[currentQ].reason}
            <br><b>${examT.selectOption}</b>: ${questions[currentQ].opts[questions[currentQ].answer]}`;
          explanationDiv.innerHTML = "";
          explanationDiv.appendChild(block);
        }
      }
    }

    questionForm.addEventListener('submit', (e) => {
      e.preventDefault();
      if (!showFeedback) {
        const selected = optionsListDiv.querySelector('input[type=radio]:checked');
        if (selected) answers[currentQ] = parseInt(selected.value, 10);
        showFeedback = true;
        renderQuestion();
        setTimeout(() => {
          const block = explanationDiv.querySelector('.explanation-block');
          if (block) block.focus();
        }, 80);
      } else {
        showFeedback = false;
        if (currentQ < questions.length - 1) {
          currentQ++;
          renderQuestion();
        } else {
          // Show the "Do you love me?" question
          questionForm.style.display = 'none';
          renderLoveQuestion();
        }
      }
    });

    function renderLoveQuestion() {
      const examT = translations[currentExamLang] || translations.en;
      loveQuestionNoDiv.textContent = '';
      loveQuestionTextDiv.textContent = examT.loveQ;
      loveOptionsListDiv.innerHTML = '';
      loveAnswer = null;
      examScreen.style.display = '';
      loveForm.style.display = '';
      // Insert options
      examT.loveOpts.forEach((opt, idx) => {
        const id = `loveopt_${idx}`;
        const optDiv = document.createElement('div');
        optDiv.style.display = 'flex';
        optDiv.style.alignItems = 'center';
        const input = document.createElement('input');
        input.type = 'radio';
        input.id = id;
        input.name = 'love-option';
        input.value = idx;
        input.className = 'option-input';
        input.required = true;
        const label = document.createElement('label');
        label.htmlFor = id;
        label.className = 'option-label';
        label.textContent = opt;
        optDiv.appendChild(input);
        optDiv.appendChild(label);
        loveOptionsListDiv.appendChild(optDiv);
      });
    }

    loveForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const selected = loveOptionsListDiv.querySelector('input[type=radio]:checked');
      if (selected) loveAnswer = parseInt(selected.value, 10);
      endExam();
    });

    function updateTimer() {
      if (!startTime) return;
      const t = translations[currentExamLang] || translations.en;
      const elapsed = Math.floor((Date.now() - startTime)/1000);
      const mins = Math.floor(elapsed / 60);
      const secs = elapsed % 60;
      examTimerDiv.textContent = `${t.timeTaken} ${mins}:${secs.toString().padStart(2,'0')}`;
    }

    function endExam() {
      clearInterval(timerInterval);
      examScreen.style.display = 'none';
      loveForm.style.display = 'none';
      renderResults();
      resultsScreen.style.display = '';
    }

    function renderResults() {
      const t = translations[currentExamLang] || translations.en;
      let score = answers.reduce((acc, ans, i) => acc + (ans === questions[i].answer ? 1 : 0), 0);
      scoreDiv.textContent = `${t.score} ${score}/${questions.length}`;
      const elapsed = Math.floor((Date.now() - startTime)/1000);
      const mins = Math.floor(elapsed / 60);
      const secs = elapsed % 60;
      timeTakenDiv.textContent = `${t.timeTaken} ${mins}:${secs.toString().padStart(2,'0')}`;
      loveMsgDiv.textContent = t.love;
      restartBtn.textContent = t.restart;
      // Show love answer
      if (loveAnswer !== null) {
        loveAnswerMsgDiv.style.display = "";
        loveAnswerMsgDiv.textContent = t.loveLabel + t.loveOpts[loveAnswer];
        if (t.loveOpts[loveAnswer].toLowerCase() === "no" || t.loveOpts[loveAnswer] === "لا" || t.loveOpts[loveAnswer].toLowerCase() === "non") {
          loveAnswerMsgDiv.style.color = "#b91c1c";
          loveAnswerMsgDiv.style.fontWeight = "bold";
        } else {
          loveAnswerMsgDiv.style.color = "#e11d48";
          loveAnswerMsgDiv.style.fontWeight = "500";
        }
      } else {
        loveAnswerMsgDiv.style.display = "none";
      }
      setTimeout(() => restartBtn.focus(), 150);
    }

    restartBtn.addEventListener('click', () => {
      resultsScreen.style.display = 'none';
      landingScreen.style.display = '';
    });

    // Init
    updateNumQuestionOptions();
    updateExamTime();
  </script>
</body>
</html>
